[{"title":"Cyber Security 101 第六部分 密码学(待更新)","path":"/Cyber-Security-101-6/","content":"探索各种对称和非对称加密算法。发现哈希算法在日常系统中的用途。 密码学基础知识密码学的最终目的是确保 在存在对手的情况下也能进行安全通信。 “安全”一词涵盖了通信数据的机密性和完整性。 密码学可以定义为在预期存在对手和第三方的情况下，安全通信和数据保护技术的实践和研究。换句话说，这些对手不应该能够泄露或更改消息的内容。 相关概念 明文Plaintext：加密前原始、可读的消息或数据，可以是文档、图像、多媒体文件或其他二进制数据。 密文Ciphertext：加密后不可读的、经过扰乱的消息版本。理想情况下，除大致大小外，无法从中获取关于明文的任何信息。 密码Cipher：将明文转换为密文并能逆向转换的算法或方法，通常由数学家开发。 密钥Key：密码用于加密或解密数据的一串比特。一般来说，使用的密码是公开知识，但密钥必须保密，除非是非对称加密中的公钥（后续任务将讨论非对称加密）。 加密Encryption：使用密码和密钥将明文转换为密文的过程。与密钥不同，密码的选择是公开的。 解密Decryption：加密的逆过程，使用密码和密钥将密文转换回明文。尽管密码是公开知识，但在不知道密钥的情况下恢复明文应是不可能的（不可行的）。 古典密码凯撒密码将明文的每个字母 按字母表 一起右移 X 位，作为 密文 英文字母表有 26 个字母，移动 26 位将使字母保持不变；因此，使用凯撒密码加密的有效密钥有 25 个。 按照今天的标准，由于密码是公开的，凯撒密码被认为是不安全的。 加密类型对称加密使用相同密钥对数据进行加密和解密。密钥必须保密 DES 3DES AES 非对称加密使用一对密钥，使用公钥对数据进行加密，私钥解密 RSADiffie-Hellman 密钥交换SSH数字签名和证书PGP和GPG哈希基础知识哈希函数存储密码的安全问题使用哈希算法进行安全密码存储识别密码哈希值密码破解完整性检查的哈希算法","categories":["Cyber Security 101"]},{"title":"Cyber Security 101 第五部分 网络(待更新)","path":"/Cyber-Security-101-5/","content":"了解 OSI 模型和 TCPIP模型。探索日常使用的各种网络协议以及WireShark、Tcpdump、Nmap的使用 第一部分 网络概念仅对基础知识做总结，不展开 OSI 模型 TCPIP 模型 应用层（OSI的应用层、表示层、会话层） 传输层 网络层 链路层 物理层 IP地址和子网IP 地址是网络上主机的标识符 分为 IPv4 （4字节）和 IPv6 （6字节） IPv4地址：192.168.1.10：网络地址255：广播地址 子网子网是为了缓解 IPv4 短缺的问题而设计 如图，该设备使用子网掩码 255.255.255.0 划分网络 设备的 IP 地址为：192.168.1.101/24 左边 24 位在整个子网内保持不变 子网 IP 地址范围为：192.168.1.1 ~ 192.168.1.254 192.168.66.0和192.168.66.255分别是网络地址和广播地址。 私有 IP 地址私有 IP 地址是根据 RFC 1918 定义的 IP 地址范围，专门用于私有网络（如家庭、办公室或企业内部网络）。 这些地址不会直接路由到公共互联网，只能在本地网络中使用。 缓解了IPv4地址短缺的问题 私有 IP 地址通常由路由器或网络设备通过 DHCP（动态主机配置协议）或静态分配给设备，用于内部通信。例如，电脑、手机或智能设备在家里连接 Wi-Fi 时，通常会被分配一个私有 IP 地址。 10.0.0.0- 10.255.255.255（10/8） 172.16.0.0- 172.31.255.255（172.16/12） 192.168.0.0- 192.168.255.255（192.168/16） UDP和TCPIP 地址标识主机，使用端口号区分进程，端口号使用两个字节，范围1 ~ 65535，0是保留端口 UDP无连接、不可靠的传输协议 缺点：不保证数据按序到达、不重传丢失数据、无流量控制 优点：速度快、开销低、支持多对多通信 TCP面向连接、可靠的传输协议 TCP连接通过三次握手建立。使用两个标志：SYN（同步）和 ACK（确认）。 SYN 数据包：客户端通过向服务器发送 SYN 数据包来发起连接。此数据包包含客户端随机选择的初始序列号。 SYN-ACK 数据包：服务器使用 SYN-ACK 数据包响应 SYN 数据包，该数据包添加了服务器随机选择的初始序列号。 ACK 数据包：当客户端发送 ACK 数据包以确认收到 SYN-ACK 数据包时，三次握手就完成了。 四次挥手关闭连接 数据传输：保证数据按序、无差错、不丢失地传输，提供错误检测和重传机制。 缺点：开销较大、速度较慢 优点：可靠性高 封装 用户数据 数据报（段）TCP segment UDP datagram 网络数据包 packet 数据链路帧 frame 远程登录TELNET（电传打字网络）协议是一种用于远程终端连接的网络协议。 TELNET 客户端允许您连接到远程系统并与之通信，以及发出文本命令。 telnet 10.10.30.254 13 # 连接到10.10.30.254的13端口 telnet 10.10.30.254 80 # 80端口：HTTP服务GET / HTTP/1.1 # /标识资源路径，为空表示访问服务器根目录Host: your_host # 正在请求的主机# 两次回车 第二部分 网络基础知识DHCP 动态主机配置协议服务器的网络配置通常固定，可以手动配置。但移动设备网络配置不固定。 DHCP：采用自动化方式配置联网设备 遵循四个步骤： DHCP发现：客户端广播 DHCPDISCOVER 消息，寻找本地DHCP服务器（如果存在）。 DHCP提供：服务器以 DHCPOFFER 消息进行响应，其中包含可供客户端接受的 IP 地址。 DHCP请求：客户端以 DHCPREQUEST 消息进行响应，表明它已接受提供的 IP。 DHCP确认：服务器以 DHCPACK 消息进行响应，以确认提供的 IP 地址现已分配给该客户端。 在四个步骤完成之前 客户端是没有 IP 配置的，使用 0.0.0.0 以及本机 MAC 地址向广播 IP 地址 255.255.255.255 和 广播 MAC 地址 ff:ff:ff:ff:ff:ff发送消息，服务器使用发送的 MAC 地址标识设备（链路层） DHCP 过程结束时，设备将收到访问互联网所需的所有配置： IP 地址 将数据包路由到本地网络之外的网关 用于解析域名的 DNS 服务器 ARP 地址解析协议 48位 MAC 地址 两种常用数据链路层：以太网、WIFI 同一以太网上的两台设备 需要知道 对方的IP地址和MAC地址才能一对一联系，一种思路是向 DHCP 服务器查询，另一种就是 ARP地址解析协议 ARP 地址解析协议 ARP 请求：请求者将 目的IP 地址发送到广播 MAC 地址，子网内所有联网设备都会受到请求 ARP 应答：目的 IP 地址受到请求后，答复 MAC 地址 ARP 请求或ARP 应答并非封装在 UDP 或 IP 数据包中，而是直接封装在以太网帧中。 ARP 允许从第 3 层网络层寻址到第 2 层链路层寻址的转换。 ARP协议的必要性在于它提供了一种简单、分布式、高效的 IP 到 MAC 地址解析机制，适用于各种网络环境（无论是否有DHCP服务器）。 直接从DHCP服务器获取MAC地址虽然理论上可行，但会引入额外的复杂性、延迟和单点故障风险，而ARP通过广播和缓存机制很好地解决了这些问题。 ICMP 互联网控制消息协议主要用于网络诊断和错误报告 ping：使用 ICMP 测试与目标系统的连接，测量往返时间 RTT traceroute：使用 ICMP 跟踪主机到目标的路由 路由协议 OSPF（开放最短路径优先）：OSPF 是一种路由协议，允许路由器共享网络拓扑信息，并计算出最高效的数据传输路径。它通过路由器之间交换其所连接链路和网络状态的更新来实现这一点。这样，每个路由器都拥有完整的网络地图，并可以确定到达任何目的地的最佳路由。 EIGRP（增强型内部网关路由协议）：EIGRP 是 Cisco 专有的路由协议，它融合了不同路由算法的诸多特性。它允许路由器共享其可到达网络的信息以及与这些路由相关的成本（例如带宽或延迟）。然后，路由器会利用这些信息来选择最高效的数据传输路径。 BGP（边界网关协议）：BGP 是互联网上使用的主要路由协议。它允许不同的网络（例如互联网服务提供商的网络）交换路由信息，并建立数据在这些网络之间传输的路径。BGP 有助于确保数据即使在跨越多个网络时也能在互联网上高效路由。 RIP（路由信息协议）：RIP 是一种简单的路由协议，常用于小型网络。运行 RIP 的路由器会共享它们可以到达的网络以及到达目标网络所需的跳数（路由器数）。因此，每个路由器都会根据这些信息构建路由表，选择到达每个目标网络的跳数最少的路由。 NAT解决 IPv4 地址耗尽的一种方法就是 网络地址转换 NAT NAT 的理念在于使用 一个公网 IP 地址 为 多个私有 IP 地址 提供互联网访问。 路由器维护一个表，将内部 IP 地址和端口号与其外部 IP 地址和端口号进行映射。 如图，从笔记本电脑的角度来看，该连接是从其 IP 地址192.168.0.129发起的，TCP 源端口号为15401； 然而，Web 服务器会将此连接视为从 212.3.4.5 TCP 端口号19273 建立的 路由器无缝地执行此地址转换。 这种转换受到路由器端口数限制，65536 第三部分 网络核心协议DNS 域名系统DNS 负责将域名映射到 IP 地址 DNS 流量默认使用UDP端口 53，并将TCP端口 53 作为默认回退端口。 DNS 有不同类型： A：将主机名映射到一个或多个 IPv4地址 AAAA：IPv6 CNAME：将域名映射到另一个域名 MX：指定负责处理域电子邮件的邮箱服务器 可以使用 nslookup在命令行中查找域的 IP 地址 WHOISWHOIS 记录提供了注册域名实体的信息 Linux 上可以使用 whois 查询域名信息 HTTP(S)启动浏览器时，主要使用HTTP和 HTTPS 协议。HTTP代表超文本传输协议；HTTPS 中的 S 代表安全。该协议依赖于TCP，并定义了 Web 浏览器与 Web 服务器的通信方式。 Web 浏览器通常向 Web 服务器发出的一些方法如下： GET从服务器检索数据，例如 HTML 文件或图像。 POST允许我们向服务器提交新数据，例如提交表单或上传文件。 PUT用于在服务器上创建新资源以及更新和覆盖现有信息。 DELETE，用于删除服务器上的指定文件或资源。 HTTP和 HTTPS 通常分别使用TCP端口 80 和 443，较少使用其他端口，例如 8080 和 8443。 GET /index.html HTTP/1.1Host: www.example.com FTP：传输文件与旨在检索网页的HTTP不同，文件传输协议 ( FTP ) 旨在传输文件。因此，FTP 的文件传输效率非常高，并且在所有条件相同的情况下，它可以实现比HTTP更高的速度。FTP 命令通常在命令行或专用软件中使用。 FTP协议定义的示例命令如下： USER用于输入用户名 PASS用于输入密码 RETR（retrieve）用于从FTP服务器下载文件到客户端。 STOR(store) 用于将文件从客户端上传到FTP服务器。 FTP服务器默认监听TCP端口 21；数据传输通过从客户端到服务器的另一个连接进行。 SMTP：发送电子邮件POP3：接收电子邮件IMAP：同步电子邮件第四部分 网络安全协议TLS（ transport Layer Security）安全套接字层 (SSL) 和传输层安全性 (TLS) 是用于加密客户端（例如 Web 浏览器）与服务器之间交换数据的协议。SSLTLS 可视为一种封装，它加密各种通信协议（例如HTTP和FTP），从而创建 HTTPS 和 FTPS。SSL 如今已不常用，因为 TLS 已逐渐取代它。 TLS 是传输层的加密协议，允许客户端和服务器在不安全的网络上进行安全通信。这里的 安全 指机密性、完整性 SSLTLS工作流程SSLTLS 握手用于通过以下步骤加密客户端与服务器之间的通信： 客户端问候消息：客户端向服务器发送问候消息，包含客户端支持的 TLS 版本、密码套件以及随机字节。 服务器问候消息：服务器回复问候消息，提供其证书、选定的密码套件和随机字节。 认证：客户端通过发行证书的证书颁发机构验证服务器的证书。例如，访问Google时，Google会分享其证书，浏览器通过预装的证书颁发机构证书进行验证。 预主密钥：客户端使用服务器的公钥（从服务器证书中获取）加密随机字节。 预主密钥解密：服务器使用其私钥解密预主密钥。 会话密钥生成：客户端和服务器基于客户端随机字节、服务器随机字节和预主密钥生成会话密钥。双方将得到相同的结果； 此会话密钥不传输，加密和解密基于此密钥。 准备消息：客户端和服务器使用会话密钥发送“完成”消息，表示会话已准备好传输。此时，客户端和服务器可以通过SSLTLS加密连接交换消息。 HTTPSSMTPS、POP3S、IMAPSSSHSFTP、FTPSVPN第五部分 WireShark第六部分 Tcpdump第七部分 Nmap","categories":["Cyber Security 101"]},{"title":"Cyber Security 101 第四部分 命令行","path":"/Cyber-Security-101-4/","content":"介绍 Windows 命令行和MS PoweShell，以及 Linux 操作系统中 Bash 的用法，包括编写 Shell 脚本 cmdCMD命令属于批处理语言（Batch Script），是一种基于 Windows 命令行环境的脚本语言。 Windows环境下默认命令行解释器是 cmd.exe 基本系统信息set # 检查路径ver # 确定操作系统版本systeminfo # 系统信息介绍cls # 清理cmd屏幕# 命令 | more # 一页一页输出 网络故障排除ipconfig # 检查网络信息，后可加/allping example.com # 检查服务器是否可访问tracert example.com # 跟踪到达目标所经过的网络路由nslookup example.com # 查找主机/域并返回其IP地址netstat # 显示当前网络连接和监听端口# -a显示所有已建立的连接和监听端口# -b显示与每个监听端口和已建立的连接相关的程序# -o显示与连接关联的进程 ID ( PID )# -n使用数字形式表示地址和端口号 文件和磁盘管理cd # 不带参数：显示当前驱动器和目录# 带参数（文件夹路径）：切换目录dir # 查看子目录 # /a 显示隐藏文件 # /s 显示当前目录和子目录所有文件tree # 以直观方式标识目录和子目录mkdir # 创建目录 makermdir # 删除目录 removetype # 查看文本文件内容copy # 复制文件move # 移动文件del # 删除文件erase # 删除文件 可以使用通配符 * 引用多个文件 # 将所有md文件复制到目录copy *.md C:\\Markdown 任务和流程管理tasklist # 列出正在运行的进程，支持筛选tasklist /？ # 查看帮助页面# 查找与notepad.exe相关进程tasklist /FI imagename eq notepad.exe taskkill /PID target_pid # 终止进程 其他命令chkdsk # 检查文件系统和磁盘卷 是否存在错误和坏扇区driverquery # 显示已安装的设备驱动程序列表sfc /sacnnow # 扫描系统文件是否有损坏，并尽可能修复 shutdown /? # 关机、重启、注销等等 PowerShellPowerShell 是一种功能更强大的脚本语言，基于 .NET 框架，专为 Windows 系统管理设计。 面向对象，可以处理复杂数据类型并与系统组件交互 基本语法PowerShell 命令 被称为cmdlets ，遵循一致的Verb-Noun命名约定 使用 Get-Command 查看所有 cmdlet，Alias，Function 使用 Get-Help 命令 可获得命令使用帮助 Get-Alias # 列出所有可使用的别名Get-Command -CommandType Function # 获取函数命令列表Get-Command -Verb Remove # 动词为 Remove 的命令Get-Command -Name Remove* # 使用通配符，同样查询以 Remove 开头的命令 PowerShell 还可以从在线存储库下载其他 cmdlet 来扩展其功能 Find-Module -Name “name” Install-Module -Name “name” 文件系统Get-ChildItem # 浏览目录并查看内容Set-Location # 更改当前目录New-Item -Path .\\file -ItemType Directory # 创建文件夹New-Item -Path .\\text.txt -ItemType File # 创建文件Remove-Item # 删除目录/文件Copy-Item # 相当于copyMove-Item # 相当于moveGet-Content # 相当于cat 管道运输、过滤、排序Get-ChildItem | Sort-Object LengthGet-ChildItem | Where-Object -Property Extension -eq .txt Get-ChildItem | Where-Object -Property Name -like ship* 管道运输符 | 将 Get-ChildItem 的执行结果 传输到后面 Get-ChildItem | Where-Object -Property Length -gt 10 # 筛选大于10的项目Get-ChildItem | Sort-Object Length -Descending | Select-Object -First 1 # 找出最大的项目 系统和网络信息Get-ComputerInfo # 查询全面的系统信息Get-LocalUser # 列出所有本地用户账户Get-NetIPConfiguration # 系统网络接口信息Get-NetIPAddress # 系统网络IP地址信息 实时系统分析Get-Process # 显示所有运行进程Get-Service # 显示所有服务Get-NetTCPConnection # 显示当前TCP连接Get-FileHash # 生成文件哈希 Get-FileHash -Path .\\ship-flag.txt # 生成文件哈希 脚本 对于事件响应人员、恶意软件分析师和威胁猎手等蓝队专业人员来说， PowerShell脚本可以自动执行许多不同的任务，包括日志分析、检测异常和提取入侵指标 (IOC)。这些脚本还可用于对恶意代码（恶意软件）进行逆向工程或自动扫描系统以查找入侵迹象。 对于红队（包括渗透测试人员和道德黑客）而言，PowerShell脚本可以自动执行诸如系统枚举、执行远程命令以及编写混淆脚本以绕过防御等任务。它与所有类型的系统深度集成，使其成为模拟攻击和测试系统抵御现实威胁能力的强大工具。 在网络安全的背景下，系统管理员可以利用PowerShell脚本自动执行完整性检查、管理系统配置和保护网络，尤其是在远程或大规模环境中。PowerShell脚本可以用于强制执行安全策略、监控系统健康状况并自动响应安全事件，从而增强整体安全态势。 编写脚本难度很高，暂时略过 Invoke-Command 它能够实现高效的远程管理，并结合脚本功能，实现跨多台计算机的任务自动化。此外，它还可用于在渗透测试人员（或攻击者）的攻击过程中在目标系统上执行有效载荷或命令。 Invoke-Command -ComputerName Server01 -Credential Domain01\\User01 -ScriptBlock Get-Service -Credential指凭据。远程连接设备 server01 并执行Get-service Linux Shell基础命令 pwdcd Filelscat filename.txtgrep THM file.txt # 在文本文件中搜索THM Linux Shell有多种类型 echo $SHELL # 查看当前Shell类型cat /etc/shells # 列出系统中可以用的终端 Bash 、 Fish 、 Zsh三种 Shell ： history # 查看命令历史记录# 上下键切换历史命令 Shell脚本创建一个Bash 脚本 frist_script.sh，扩展名为 .sh 首行 定义 脚本执行解释器 #!/bin/bash echo Hello,Whats your name?read nameecho Welcome,$name 使用 bash 执行 bash frist_script.sh 授予脚本执行权限然后直接执行 chmod +x frist_script.sh./frist_script.sh 变量your_name=yang # 变量名和等号间不能有空格echo $your_name # 使用变量需要加上 $echo $your_name # 帮助解释器识别变量的边界readonly your_name # 声明变量只读，后续无法修改unset your_name # 删除变量，但不能删除只读变量 变量类型：字符串、整数、数组、环境变量、特殊变量 my_string=Hello # 或单引号，或不用引号declare -i my_integer=42 # 声明变量为整数my_array=(1 2 3 4 5) echo $PATH # PATH是环境变量，包含了操作系统搜索可执行文件的路径 特殊变量： $0 表示脚本名称 ，$1、 $2 表示脚本参数 $# 表示传递给脚本的参数数量，$? 表示上一个命令的退出状态等 字符串变量，双引号内可以使用变量、转义字符，而单引号内所有内容都会原样输出 your_name=yangstring=Hello,$your_name ! # 字符串拼接（单引号也一样）echo $string read name # 接收用户的输入，存储在变量nameecho $#name # 获取字符串长度，$#name 等价于 $#name[0]echo $#name:1:3 # 从第2个字符开始截取3个字符 echo $array_name[@] # 获取数组中的所有元素 传递参数执行一个脚本，传递 1、2、3 三个参数 bash test.sh 1 2 3 在脚本内部，使用 $0 表示脚本名称 ，$1、 $2 、$3表示脚本参数 还可以用$# 表示传递给脚本的参数数量，$? 表示上一个命令的退出状态 $* 显示所有参数 $$ 获取脚本运行的当前进程ID Shell运算符介绍算术运算符、关系运算符、逻辑运算符 原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 awk 和 expr，expr 最常用。 expr 是一款表达式计算工具，使用它能完成表达式的求值操作。 val=`expr 2 + 2` 常用算术运算符：+ - * / % = == != 关系运算符只支持数字，不支持字符串，除非字符串的值是数字。 常用关系运算符：-eq -ne -gt -lt -ge --le if [ $a -eq $b]then echo $a -eq $b : a 等于 belse echo $a -eq $b : a 不等于 bfi 逻辑运算符 || 还有字符串运算符、文件测试运算符、自增自减运算符等等 也可以使用 (()) 进行算术运算，也可直接使用 echoecho -n Loading... # 不换行输出echo -e First line Second line # 启用转义字符echo hello output.txt # 输出到文件并覆盖， 是追加# 彩色文本，\\033[0m 重置属性，42绿背景，31红字echo -e \\033[42;31mGreen Background with Red Text\\033[0m printf暂时略过 条件if conditionthen command1 command2 ... commandN else commandfi 代码块不可为空，要么就不写 else if condition1then command1elif condition2 then command2else commandNfi 循环#!/bin/bashfor i in 1..10;doecho $idone while conditiondo commanddone until conditiondo commanddone break 跳出所有循环 continue 跳出当前循环 case $value in value1) command1 command2 ... commandN ;;value2) command1 command2 ... commandN ;;esac Shell函数[ function ] funname [()] action; [return int;] 函数调用，像脚本一样传参 funname 1 2 3 示例： #!/bin/bashfunction demoFun1() echo 这是我的第一个 shell 函数! return `expr 1 + 1`demoFun1echo $?echo $? 第一个 echo 显示函数返回值2 第二个 echo 显示上一条命令正确执行的返回值 0 Shell 输入输出重定向 Shell 文件包含Shell 可以包含外部脚本 source ./test1.sh# 或. ./test1.sh","categories":["Cyber Security 101"]},{"title":"Cyber Security 101 第三部分 AD和Windows基础知识","path":"/Cyber-Security-101-3/","content":"先介绍Active Directory基础知识 再介绍 Windows 的 NTFS 文件系统、UAC权限控制、系统配置、资源监控、注册表以及安全相关功能。 第一部分 Active DirectoryActive Directory是Windows服务器环境中的目录服务。几乎任何中大型企业为了集中化管理，都会部署AD 本质上 AD 是一个分层式的、分布式的数据库，用于存储、组织并提供对网络环境中各种对象和资源信息的访问。 其核心协议是实现身份认证和授权的 LDAP (Lightweight Directory Access Protocol)。 逻辑结构： 域 Domain：使用DNS域名标识，是一个安全对象的集合，这些对象共享目录数据库和安全策略 树 Tree：一个或多个域的层次化组合，这些域共享一个连续的 DNS 命名空间 林 Forest：包含一个或多个共享共同架构 (Schema) 和全局编录 (Global Catalog) 的域。林内的所有域通过可传递的信任关系自动建立双向信任。 组织单位 OU：域内组织对象的最小单位，是应用组策略和委派管理权限的最小作用域单位。 物理结构： 域控制器 DC：运行Active Directory 服务的服务器 站点 Site Active Directory用户：用户是安全主体之一，是可以对网络中的资源进行操作的对象。 人员用户：用户通常代表组织中需要访问网络的人员，例如员工。 服务用户：每个服务都需要一个用户才能运行，这就是服务用户，只拥有运行特定服务所需的权限。 机器：每台加入 Active Directory 域的计算机都会创建一个计算机对象。计算机也被视为“安全主体”，机器账户本身指计算机的本地管理员。通常 计算机名称+$ 就是机器账户名。 安全组：类似用户组，可用于向用户授予特定权限。如域管理员、服务器操作员、备份操作员、账户操作员、域用户、域计算机、域控制器 登录域控制器，运行 Active Directory Users and Computers 。 组织单位 OU ：容器对象，可用于对用户和计算机进行分类。一个用户一次只能属于一个 OU 如图，THM 组织单元有5个子组织单元。图中四个用户 同属于 Sales 组织单元 OU 是应用组策略和委派管理权限的最小作用域单位。 组策略销售所需要的权限是相同的，应该给销售人员统一配置权限。 根据不同需要可以给不同 OU 分别配置不同权限策略，这就是组策略。 使用Group Policy Management工具查打开 组策略 配置操作界面 在 Group Policy Objects 目录下 创建组策略，然后就可以链接到其他 组织单元 （子组织单元也会影响） 图中 GPO 内有三个组策略，已经应用于 OU Security Filtering ：安全筛选，默认情况下组策略会应用到所有安全对象 Settings 栏里可以看到具体包含哪些权限 修改组策略，右键 选中 Edit，会弹出包含许多条目的新界面，如图 组策略分发域控制器上一个名为 SYSVOL 的特定网络共享文件夹，存放有 组策略对象 数据。 DC 上的默认路径：C:\\Windows\\SYSVOL\\sysvol\\ 域内的用户可以通过 域名\\SYSVOL 来访问 域成员会定期联系 DC 查询是否 需要更新GPO 也可以在 PoweShell 使用gpupdate /force来立即更新 Delegation 权限委派授予用户特定权限，让他们能在 OU 上执行高级任务，而无需域管理员介入。 右键 需要委派给其他人的 OU，选择 Delegate Control ，进入新界面进行具体操作。 被委派的用户由于没有打开 Active Directory Users and Computers 的权限，需要使用Powershell来执行操作。 设备管理身份验证Windows域中的网络身份验证 都需要 域控制器DC 来验证配置是否正确 使用两种协议： Kerberos：新的默认协议 NetNTLM：旧的身份验证协议，仍然兼容 KerberosKerberos 是 Windows 域环境中默认的身份验证协议，依赖于 KDC（密钥分发中心），通常运行在域控制器（DC）上。KDC 包含两个主要服务： 认证服务（AS，Authentication Service）：负责验证用户身份并颁发 TGT（Ticket Granting Ticket）。 票据授予服务（TGS，Ticket Granting Service）：根据 TGT 颁发特定服务的 服务票据（Service Ticket）。 TGT 作为用户身份的通用凭证，允许用户在有效期内多次请求服务票据 Kerberos 工作流程简述： 用户通过用户名和密码（或密钥）向 KDC 的认证服务（AS）请求身份验证。 KDC 验证用户身份后，返回一个 TGT，该票据包含用户的身份信息和时间戳，加密后存储在客户端。 当用户需要访问特定服务时，客户端使用 TGT 向 KDC 的票据授予服务（TGS）请求 服务票据。 TGS 返回一个针对特定服务的 服务票据，用户出示该票据给目标服务，服务验证票据后授予访问权限。 票据有效期：TGT 和服务票据都有时间限制（通常为 10 小时），到期后需续期或重新认证。 NetNTLMNetNTLM（也称为 NTLM，NT LAN Manager）是 Windows 域环境中较旧的身份验证协议，通常作为 Kerberos 的备用协议，用于不支持 Kerberos 的场景或向下兼容旧系统。 仅做介绍 树、林、信任关系AD支持集成多个域，将网络划分为可独立管理的单元。 树的每个域都有各自的 DC ，有各自的域管理员，以及可以控制企业中所有内容的 企业管理员。 不同的命名空间 也可以 统一管理。 将多个具有不同命名空间的树合并到同一个网络中，这种结构称为林 双向信任关系是域之间的一种认证机制，允许用户跨域被识别和授权，但它本身并不自动授予资源访问权限。 管理员需要进一步配置具体的访问权限，以决定哪些用户可以访问哪些资源，从而实现安全的资源共享和跨域协作。 第二部分 文件系统与权限文件系统：NTFSNTFS 被称为日志文件系统，发生故障可以使用日志中的信息自动修复磁盘上的文件 权限设置 Read Write Read Execute List Folder Contents Modify Full Control 继承性：子文件夹和文件继承父文件夹的权限 显式权限：可以为特定文件及文件夹设置独立权限，覆盖继承的权限 备用数据流ADS每个文件至少有一个默认数据流 $DATA，ADS 允许文件附加额外的命名数据流，与主数据流并存，可以存储独立的数据。 元数据存储：Windows 常使用 ADS 存储文件的元数据，如文件的摘要信息或缩略图。 安全和隐藏数据：ADS 可用于隐藏数据（例如，恶意软件可能利用 ADS 隐藏恶意代码）。 Windows\\System32C:\\Windows 即包含操作系统的文件夹，环境变量是 %windir% 环境变量存储有关操作系统环境的信息。此信息包括操作系统路径、操作系统使用的处理器数量以及临时文件夹的位置等详细信息 其中的 System32文件夹中的内容对操作系统至关重要。 账户 管理员：可以对系统进行更改。添加用户、删除用户、修改组、修改系统设置等。 标准用户：只能更改属于用户的文件夹文件，而不能执行系统级更改，例如安装程序。 创建用户账户时会为该用户创建一个配置文件。每个用户配置文件文件夹位于 C:\\Users。 每个用户配置文件都包含共同的文件夹：桌面、文件、下载、音乐、图片 在运行窗口：lusrmgr.msc 可以查看用户和群组的详细信息。 User Account Control（UAC）任意管理员用户都可以修改系统设置，引入 UAC 以限制权限滥用。 即管理员用户登录时，默认情况下会话不会以管理员权限运行。当需要执行需要更高级别权限的操作时，系统会提示用户确认是否允许该操作运行。 不适用于内置本地管理员账户，日常不会使用这个账户。 这就是一些安装程序图标右下角会有个盾牌的原因，因为它需要更高级别的权限来安装 UAC 可以设置控制强度 运行提示符：UserAccountControlSettings.exe 设置和控制面板设置日常使用更多 控制面板可以访问更复杂设置和执行复杂操作。 任务管理器Ctrl + Shift + Esc打开任务管理器 可以查看正在运行的程序、进程，以及性能、服务等详细信息。 第三部分 系统配置及相关工具简单介绍 系统配置MSConfig 程序（系统配置实用程序）用于高级故障排除，主要帮助诊断启动问题。 直接Windows搜索系统配置 常规：选择Windows启动时加载的设备和服务 引导：为操作系统定义各种启动选项 服务：列出系统配置的所有服务（服务是一种在后台运行的特殊应用程序） 启动：微软建议使用任务管理器来管理启动项 工具：列出各种实用程序，可以通过运行提示符（Win+R）、命令提示符和运行按钮来启动 运行提示符：control.exe 进入控制面板 计算机管理 compmgmt.msc 计算机管理实用程序 系统工具 任务计划程序：可以创建和管理常见任务，运行应用程序、脚本等，并且可以配置任务在任意时间点运行 事件查看器：可以记录五种类型的事件。这些事件记录可以被视为审计线索，用于了解计算机系统的活动。 共享文件夹：其他人可以连接的共享和文件夹的完整列表。 本地用户和组 性能：有 性能监视器 （perfmon）程序 设备管理器：查看和配置硬件，例如禁用连接到计算机的任何硬件。 存储 磁盘管理：执行高级存储任务，设置新驱动器、扩展或缩小分区、分配或更改驱动器号 服务和应用程序：可以查看服务 系统信息 msinfo32.exe 硬件资源：不懂硬件看不懂 组件：可以查看计算机上安装的硬件设备的具体信息 软件环境：可以查看操作系统内置软件以及您已安装软件的信息。此部分还显示其他详细信息，例如环境变量和网络连接。 资源监视器 resmon.exe 资源监视器显示每个进程以及CPU、内存、磁盘和网络使用情况的汇总信息，此外还提供有关哪些进程正在使用各个文件句柄和模块的详细信息。 高级筛选功能允许用户隔离与一个或多个进程（应用程序或服务）相关的数据，启动、停止、暂停和恢复服务，以及从用户界面关闭无响应的应用程序。它还包括一个进程分析功能，可以帮助识别死锁进程和文件锁定冲突 命令提示符 cmdhostname # 输出计算机名称whoami # 输出登录用户的名称ipconfig # 显示计算机的网络地址设置cls # 清除屏幕 clearnetstat # 显示协议统计信息和当前的 TCP/IP 网络连接net # 管理网络资源 使用 help (net help) 命令后加 /? 显示说明（net除外） 注册表编辑器 regedt32.exeWindows 注册表 是一个中央分层数据库，用于存储为一个或多个用户、应用程序和硬件设备配置系统所需的信息。 注册表包含 Windows 在运行期间不断引用的信息，例如： 每个用户的个人资料 计算机上安装的应用程序以及每个应用程序可以创建的文档类型 文件夹和应用程序图标的属性表设置 系统上有哪些硬件 正在使用的端口 第四部分 内置安全功能简单介绍 Windows更新Windows 更新是微软为 Windows 操作系统提供的补丁、功能更新和安全修复，旨在提升系统安全性、稳定性和性能。 更新可分为 安全更新、功能更新、质量更新、驱动更新 Windows 10 和 Windows 11 设计为强制更新，普通用户无法永久禁用更新，只能推迟。 WIndows安全 病毒和威胁防护 防火墙和网络保护 应用程序和浏览器控制 设备安全 病毒和威胁防护防火墙防火墙（Firewall）监控和控制通过端口进出的网络流量。检查每一个数据包，决定是允许通过、拒绝，还是丢弃。 Windows防火墙提供三种防火墙配置文件：域、私有和公共 域：域配置文件适用于主机系统可以向域控制器进行身份验证的网络。 私人：私人配置文件是用户分配的配置文件，用于指定私人或家庭网络。 公共：默认配置文件是公共配置文件，用于指定公共网络，例如咖啡店、机场和其他地点的 Wi-Fi 热点。 应用和浏览器控制设备安全 内核隔离：防止攻击将代码插入高安全性进程 安全处理器：使用可信平台模块 (TPM) 技术，提供基于硬件的安全相关功能。TPM 芯片是一种安全的加密处理器。该芯片包含多种物理安全机制，使其具有防篡改功能，恶意软件无法篡改 TPM 的安全功能 数据加密：BitLocker 驱动器加密是一种与操作系统集成的数据保护功能，可以解决丢失、被盗或不当退役的计算机造成的数据盗窃或泄露威胁 卷影复制服务 VSS该服务创建数据的一致性快照（也称为卷影副本或时间点副本）。这些快照可以在特定时间点捕获文件、文件夹或整个驱动器的数据状态，方便备份或恢复。 系统保护功能：通过VSS支持创建、配置和删除还原点，以及执行系统还原。 安全风险：勒索软件可能删除卷影副本，导致无法通过系统还原恢复数据。","categories":["Cyber Security 101"]},{"title":"Cyber Security 101 第二部分 Linux基础知识","path":"/Cyber-Security-101-2/","content":"介绍Linux基础知识：一些基本命令，使用SSH登录Linux设备，与文件系统交互，以及一些实用工具，进程，自动化，与包管理，日志相关知识 基本命令echo Hello # 输出提供的文本whoami # 输出当前登录的用户ls # 列出目录下的文件listing,默认参数是当前目录cd # 更改目录 change directorycat # 输出文件内容pwd # 打印完整工作目录路径 print working directory find -name passwords.txt # 在当前目录下查找文件find -name *.txt # 使用*来搜索所有txt文件 grep 81.143.211.90 access.log # 搜索文件内容，展示包含所需值的条目 # shell运算符 允许终端后台允许命令 将多个命令组合在一行 重定向 与相同，但是输出不覆盖而是添加在后面 echo Hello welcome # 将 Hello 输出到文本文件，内容将被覆盖echo World welcome # 将 World 添加到文本文件后（自动换行） 使用SSH登录Linux设备、执行命令、与文件系统交互 SSH（Secure Shell） ：连接远程Linux机器命令行并进行交互 ssh 账户用户名@远程机器IP地址# 然后还需输入密码 命令参数 ls -a # 将显示工作目录所有内容all，包括隐藏文件ls --help # manual使用帮助ls -lh # 列出当前目录下文件详细信息 long、human能阅读的方式 与文件系统交互 touch # 创建文件mkdir # make directory创建文件夹cp # copymv # moverm # removefile # 确定文件类型 rm note # 删除文件rm -R directory # 删除文件夹 cp note new_note # 复制时可以自动创建新文件 mv note new_note # 移动到新文件夹或新文件，不保留旧文件 file note # 确定文件类型 note: ASCII text # 表明是一个文本文件 权限ls -lh -rw-r--r-- 1 user group 4.5K Sep 2 14:30 example.txt drwxr-xr-x 2 user group 4.0K Sep 2 10:15 mydir 第1个字符：-普通文件，d目录，l符号链接 后9个字符：权限，分为三组，分别表示 文件拥有者权限、所属组权限、其他用户权限 硬链接数（如1或2）：普通文件通常为 1，目录为至少 2（包含自身和 . 目录）。 文件拥有者、文件所属组、文件大小、最后修改时间、文件名 切换用户需要知道用户名和密码 su 其他用户 Password:# 仅切换到目标身份，但保留当前用户的环境变量，且工作目录不变 su -l 用户名# 完全切换用户，并切换到HOME目录 目录 ETC：存储操作系统使用的系统文件 var：存储系统上运行的服务或应用经常访问或写入的数据，如日志文件/var/log root：root系统用户的主目录 tmp：用于存储只需访问几次的数据。重启将清除，任何用户默认都可以写入此文件夹，渗透测试中存储、枚举的理想场所 终端文本编辑器 nano vim 仅做了解 通用实用工具wgetwget 文件URL SCP（SSH）利用SSH协议在两台计算机之间传输文件，提供身份验证和加密 通过 SOURCE 和 DESTINATION 模型，SCP 允许您： 将文件和目录从当前系统复制到远程系统 scp test.txt user@IP_address:home/user/new.txt 将文件和目录从远程系统复制到当前系统 scp user@IP_address:home/user/test.txt new.txt WebPython3的“HTTPServer”会在当前目录进行文件服务 python3 -m http.server # 启动http服务（8000端口） wget http://10.10.135.215:8000/myfile 进程查看进程 所有进程（加上其他用户运行以及系统进程） ps aux top获取进程的实时统计信息 top 管理进程kill PID 在进程被终止时可以发送的一些信号： SIGTERM——终止进程，但允许它事先执行一些清理任务 SIGKILL - 终止进程 - 事后不做任何清理 SIGSTOP——停止暂停进程 进程的启动命名空间将进程彼此隔离，只有同一命名空间中的进程可以相互看到 PID为 0 的进程是系统启动时启动的 systemd是第一个启动的进程之一，管理系统进程的初始化系统。任何想要启动的进程都会作为 systemd 的子进程启动。 systemctl 是管理 systemd 服务的命令行工具，可以用于启用或停止、开机启用、禁止 服务 systemctl [option] [service]# start stop enable disable 前台和后台在命令中添加 会让进程在后台运行 CTRL + Z也可以将进程移到后台 fg 命令将后台进程重新带回前台（ foreground） 自动化cron 是一个 Linux 系统中的守护进程（daemon），在系统启动时自动运行，用于定时执行任务（称为 cron 作业，cron jobs）。 它根据预设的时间表（schedule）运行脚本、命令或程序，适合自动化任务，如定时备份、更新系统或启动应用程序。 使用 crontab（table）来管理定时任务 crontab -e # 编辑当前用户的crontabcrontab -l # 查看当前用户的crontab 格式 时 日 月 星期 命令 # *表示任意0 * * * * /usr/bin/google-chrome # 每个小时启动Google Chrome@reboot /var/opt/processes.sh # 系统启动或重启时执行脚本 包管理apt 是软件包管理命令，每当更新系统时，包含软件的仓库也会检查更新 apt updateapt install [software-name-here]apt remove [software-name-here] 仅做介绍 日志 varlogvar/log 存储各种日志 日志轮转：自动管理日志文件大小和存储，定期压缩旧日志、创建新日志、并删除过期日志 以三个日志为例： Apache2 Web服务器： /var/log/apache2/access.log：记录 Web 服务器的访问日志（每次 HTTP 请求的详细信息，如 IP、URL、状态码等）。 /var/log/apache2/error.log：记录 Apache2 的错误信息（如配置错误、页面未找到）。 fail2ban 服务：/var/log/fail2ban.log，记录 fail2ban 服务的运行状态和操作。 防止暴力破解，通过监控日志（如SSH登录）检测异常行为，并临时封禁异常IP UFW服务：/var/log/ufw.log，记录 UFW 防火墙的操作和事件。 仅做介绍","categories":["Cyber Security 101"]},{"title":"Cyber Security 101 第一部分 简介","path":"/Cyber-Security-101-1/","content":"介绍网络安全101课程，初步了解进攻性安全和防御性安全的概念，总结搜索技巧 Cyber Security 101本课程涵盖以下方面的基本概念和应用 计算机网络和密码学 MS Windows、Active Directory 和 Linux 基础知识 攻击性安全工具和系统利用 防御性安全解决方案和工具 网络安全职业 进攻性安全进攻性安全是一种主动的安全测试方法，通过模拟黑客的攻击行为来识别和利用系统、应用程序或网络中的漏洞。其目标是发现潜在的安全弱点，从而在恶意攻击者利用之前进行修复。 示例：入侵一个 模拟的FakeBank： http://fake.bank.thm 使用 Gobuster 暴力查找银行所有页面 gobuster dir -u http://fake.bank.thm -w wordlist.txt # -u 声明正在扫描的网站# -w 采用单词列表遍历查找隐藏的页面 结果找到bank-transfer转账页面，状态200 OK，代表可以访问 访问http://fakebank.thm/bank-transfer 于是获取了转账权限（可以使用ID进行转账） 通过模拟黑客入侵银行系统，发现了未经授权就可以访问的转账页面 这是一种访问控制漏洞。具体来说是不安全的直接引用 通过操纵 URL 参数、表单数据或请求体中的标识符（如用户 ID、账户 ID 或交易 ID） 无需授权，直接访问或修改他人的资源 修复漏洞需要实施严格的访问控制检查 一个类似的漏洞示例： Optus 数据泄露（2022 年，澳大利亚电信巨头） https://www.upguard.com/blog/how-did-the-optus-data-breach-happen 报告总结了原因： 一个无需身份验证的API可以访问客户敏感信息 递增使用客户标识符（递增ID即可获取所有客户ID） GobusterGo语言编写的开源命令行工具 可以用于暴力枚举Web目录、文件、DNS子域名等 gobuster dir -u 网站域名 -w 爆破字典gobuster dns -d 网站域名 -w 爆破字典 后续进一步学习使用 防御安全简介防御安全：从保护、监控和维护的角度出发，通过收集情报、检测异常、响应威胁和修复漏洞来确保系统、应用程序和网络的安全。 与进攻性安全主动寻找漏洞不同，防御性安全侧重于构建和维护安全防线，防止攻击发生并在攻击发生时快速响应。 防御安全核心领域： Security Operations Center (SOC), where we cover Threat Intelligence 情报收集 Digital Forensics and Incident Response (DFIR), where we also cover Malware Analysis 数字取证、事件响应、恶意软件分析 事件响应流程： 现代安全管理使用 Security Information and Event Management (SIEM) 系统，这是一种集成的安全管理方案， 收集安全相关信息和事件并呈现，如果检测到可疑事件会发出警报 SIEM系统模拟： 多次登录失败不一定有问题，可能只是忘记密码 注意到 IP 143.110.250.149 尝试未授权登录，最终成功，这很可疑，利用一些网站查询该 IP。 查询结果显示非常可疑，并且登录成功，可能有危险，应该进行处理。选择 SOC Team lead ，负责初始的事件处理并报告，之后交给 DFIR 最后封锁这个IP 搜索技巧谷歌搜索: 双引号表示精确搜索 site: 限制域名 - 忽略特定词语 filetype:查找文件类型（而非网页） 专业搜索引擎： Shodan 搜索联网设备 Censys 搜索互联网资产 VirusTotal 文件病毒扫描服务 Have I Been Pwned 检测某个电子邮箱地址是否被泄露 常见漏洞CVE CVE系统，漏洞字典，用CVE ID标准化每个漏洞（https://nvd.nist.gov/） 漏洞数据库，可以找到来自不同作者的漏洞利用代码 查阅官方文档","categories":["Cyber Security 101"]}]